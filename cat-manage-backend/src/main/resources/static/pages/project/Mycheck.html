<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link rel="stylesheet" type="text/css" media="screen" href="../../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../layui/css/layui.css">

    <style>
        .title {
            text-align: center;
            line-height: 30px;
            color: black;
            font-weight: 600;
            background-color: #e4e4e4;
            height: 30px;
        }

        .table {
            margin: 0;
        }

        p {
            word-wrap: break-word;
            word-break: break-all;
        }
    </style>
</head>
<body>
<a  id="return"  style="position: absolute;height: 30px;margin-left: 10px;margin-top: 30px;" type="button" class="layui-btn layui-btn-primary"><p style="line-height: 30px;text-align: center;">返&nbsp;&nbsp;&nbsp;&nbsp;回</p></a>
<a  id="check"  style="position: absolute;height: 30px;margin-left: 10px;margin-top: 60px;" type="button" class="layui-btn layui-btn-primary"><p style="line-height: 30px;text-align: center;">待审核</p></a>
<a  id="no_pass"  style="position: absolute;height: 30px;margin-left: 10px;margin-top: 90px;" type="button" class="layui-btn layui-btn-primary"><p style="line-height: 30px;text-align: center;">不通过</p></a>
<a  id="pass"  style="position: absolute;height: 30px;margin-left: 10px;margin-top: 120px;" type="button" class="layui-btn layui-btn-primary"><p style="line-height: 30px;text-align: center;">通&nbsp;&nbsp;&nbsp;&nbsp;过</p></a>




<div style="margin-top: 10px;" class="layui-row">
    <div class="layui-col-xs10 layui-col-sm10 layui-col-md10 layui-col-lg10
layui-col-xs-offset1 layui-col-sm-offset1 layui-col-md-offset1 layui-col-lg-offset1">
        <p class="title">我的审核</p>


        <div id="zijin">
        <table class="table table-striped table-bordered table-hover">
            <colgroup>
                <col width="80">
                <col width="50">
                <col width="200">
                <col width="50">
                <col width="50">
            </colgroup>
            <thead>
            <tr>
                <th style="text-align: center;">科目</th>
                <th style="text-align: center;">金额(万元)</th>
                <th style="text-align: center;">开支内容</th>
                <th style="text-align: center;">证明材料</th>
                <th style="text-align: center;">操作</th>
            </tr>
            <tr>
                <th style="text-align: center;" >合计</th>
                <th  ><p style="text-align: center;" class="res_money"></p></th>
                <th ></th>
                <th ></th>
                <th ></th>

            </tr>


            </thead>
            <tbody id="content" >
            </tbody>
        </table>
        </div>

        <div id="zijin2" style="display: none;">
            <table class="table table-striped table-bordered table-hover">
                <colgroup>
                    <col width="80">
                    <col width="50">
                    <col width="200">
                    <col width="50">
                </colgroup>
                <thead>
                <tr>
                    <th style="text-align: center;">科目</th>
                    <th style="text-align: center;">金额(万元)</th>
                    <th style="text-align: center;">开支内容</th>
                    <th style="text-align: center;">证明材料</th>
                </tr>
                <tr>
                    <th style="text-align: center;" >合计</th>
                    <th  ><p style="text-align: center;" class="res_money"></p></th>
                    <th ></th>
                    <th ></th>

                </tr>
                </thead>
                <tbody id="content2" >
                </tbody>
            </table>
        </div>
        <div id="zijin3" style="display: none;">
            <table class="table table-striped table-bordered table-hover">
                <colgroup>
                    <col width="80">
                    <col width="50">
                    <col width="200">
                    <col width="50">
                    <col width="50">
                </colgroup>
                <thead>
                <tr>
                    <th style="text-align: center;">科目</th>
                    <th style="text-align: center;">金额(万元)</th>
                    <th style="text-align: center;">开支内容</th>
                    <th style="text-align: center;">证明材料</th>
                    <th style="text-align: center;">意见</th>
                </tr>
                <tr>
                    <th style="text-align: center;" >合计</th>
                    <th  ><p style="text-align: center;" class="res_money"></p></th>
                    <th ></th>
                    <th ></th>
                    <th ></th>
                </tr>


                </thead>
                <tbody id="content3" >
                </tbody>
            </table>
        </div>

    </div>
</div>


<form class="form-horizontal" onsubmit="return false" id="form">
    <input type="hidden" id="id" name="id" value="">
    <input type="hidden" id="status" name="status" value="1">

</form>

</body>


<script src="../../js/constant.js"></script>
<script type="text/javascript" src="../../js/libs/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../../js/jq.js"></script>
<script type="text/javascript" src="../../js/plugin/bootstrapvalidator/bootstrapValidator.min.js"></script>
<script type="text/javascript" src="../../js/common.js"></script>
<script type="text/javascript" src="../../layui/layui.js"></script>

<script type="text/javascript" src="../../js/project/initData.js"></script>
<script type="text/javascript" src="../../js/project/projectDetails.js"></script>


<script>

    var id = getUrlParam("id");
    var money=0;
    var urls=[];
    $(function() {
        $.ajax({
            type: 'get',
            url: domainName + '/project-item/item/fund/use/my/' + id,
            async: false,
            contentType: "application/json; charset=utf-8",
            success: function (res) {
                var str = '';
                var str1 = '';
                var str2 = '';

                $(res).each(function () {
                    if (this.status == 1) {
                        money += this.expenditure;
                        getbudegetname(this.budget_id);
                        str += '<tr>'
                            + '<th style="text-align: center;">' + subjectName + '</th>'
                            + '<th style="text-align: center;">' + this.expenditure + '</th>'
                            + '<th style="text-align: center;">' + this.remark + ' </th>'
                            + '<th  style="text-align: center;"><a href="userfundimg.html?id=' + this.id + '">详情</a></th>'
                            + '<th style="text-align: center;">'
                            + ' <button  onclick="submit(' + this.id + ')" type="button" class="layui-btn layui-btn-primary layui-btn-xs">审核</button>'
                            + '</th>'
                            + '</tr>';
                    }
                    if (this.status == 2) {
                        money += this.expenditure;
                        getbudegetname(this.budget_id);
                        str1 += '<tr>'
                            + '<th style="text-align: center;">' + subjectName + '</th>'
                            + '<th style="text-align: center;">' + this.expenditure + '</th>'
                            + '<th style="text-align: center;">' + this.remark + ' </th>'
                            + '<th  style="text-align: center;"><a href="userfundimg.html?id=' + this.id + '">详情</a></th>'
                            + '</tr>';
                    }

                    if (this.status == 3) {
                        money += this.expenditure;
                        getbudegetname(this.budget_id);
                        str2+= '<tr>'
                            + '<th style="text-align: center;">' + subjectName + '</th>'
                            + '<th style="text-align: center;">' + this.expenditure + '</th>'
                            + '<th style="text-align: center;">' + this.remark + ' </th>'
                            + '<th  style="text-align: center;"><a href="userfundimg.html?id=' + this.id + '">详情</a></th>'
                            + '<th  style="text-align: center;">'+this.check_opinion+'</th>'
                            + '</tr>';
                    }
                })
                $(res.bill_url).each(function () {
                    urls.push(this);
                })
                $(".res_money").text(money);
                $("#content").append(str);
                $("#content2").append(str1);
                $("#content3").append(str2);
            }
        })
    })


    function getbudegetname(bid){
        $.ajax({
            type: 'get',
            url: domainName + '/project-item/item/budget/' + bid,
            async:false,
            contentType: "application/json; charset=utf-8",
            success: function (res) {
                subjectName=res.subject;
            }
        })
    }


    $("#return").click(function () {

        $(location).attr("href", "new_usefund.html?id=" + id);

    })

    function submit(id) {
        $(location).attr("href", "check_usefund.html?id=" + id);
    }
    $("#no_pass").click(function () {
        $("#zijin").css("display","none");
        $("#zijin2").css("display","none");
        $("#zijin3").css("display","block");
    })

    $("#check").click(function () {
        $("#zijin").css("display","block");
        $("#zijin2").css("display","none");
        $("#zijin3").css("display","none");
    })

    $("#pass").click(function () {
        $("#zijin").css("display","none");
        $("#zijin2").css("display","block");
        $("#zijin3").css("display","none");
    })
</script>

</html>