<!DOCTYPE html>
<html lang="en-us" id="extr-page">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" media="screen" href="../../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../layui/css/layui.css">
</head>

<body>


<a  onclick="history.back(-1);" style="position: fixed;margin-left: 5px;"  class="layui-btn layui-btn-sm"><i class="layui-icon">&#xe65c;</i></a>
<button style="width: 30px;height: 20px;float: right;margin-top: 30px;margin-right: 4%;"
        class="layui-btn layui-btn-sm" id="add_report">
    <p style="line-height: 20px;margin-left: -3px;"> <i class="layui-icon">&#xe608;</i></p>
</button>

<div  class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

    <form class="form-horizontal" onsubmit="return false" id="form">

        <fieldset>


            <table id="dt-table" class="table table-striped table-bordered table-hover"
                   style="width:100%;">

                <colgroup>
                    <col width="60">
                    <col width="230">
                    <col width="10">

                </colgroup>
                <thead>
                <tr>
                    <th style="text-align: center;">标题</th>
                    <th style="text-align: center;">内容</th>
                    <th style="text-align: center;">操作</th>

                </tr>
                </thead>
                <tbody id="report_content">
                </tbody>
            </table>

        </fieldset>
    </form>
</div>


<script src="../../js/constant.js"></script>
<script type="text/javascript" src="../../js/libs/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../../js/jq.js"></script>
<script type="text/javascript" src="../../js/plugin/datatables/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="../../js/plugin/datatables/dataTables.bootstrap.min.js"></script>
<script type="text/javascript" src="../../layui/layui.js"></script>
<script type="text/javascript" src="../../js/my/permission.js"></script>
<script type="text/javascript" src="../../js/common.js"></script>
</body>

<script>
    var id = getUrlParam("id");
    $("#add_report").click(function () {
        $(location).attr("href", "add_report.html?id=" + id);
    })

    layui.use(['layer', 'laydate', 'upload'], function () {
        var layer = layui.layer
            , upload = layui.upload
            , laydate = layui.laydate;

        lay('.date').each(function () {
            laydate.render({
                elem: this
                , format: 'yyyy年MM月dd日'
                , trigger: 'click'
            });
        });
    });

    $(function(){
        $.ajax({
            type: 'get',
            url: domainName + '/project-report/report/getAllReport/'+id,
            contentType: "application/json; charset=utf-8",
            success: function (res) {
                var str = '';
                $(res).each(function () {
                    str += '<tr>'
                        + '<th style="text-align: center;">' + this.title + '</th>'
                        + '<th style="text-align: center;">' + this.content + '</th>'
                        + '<th style="text-align: center;">'
                        + ' <div style="width: 100%;height: 20px;align-self: center;">'
                        + '<button onclick="updat_report('+this.id+')" style="height: 20px;width: 30px;" class="layui-btn layui-btn-sm">'
                        + '<p style="line-height: 20px;margin-left: -3px;"><i class="layui-icon">&#xe642;</i></p>'
                        + '</button>'
                        + '<button onclick="delete_report('+this.id+');" style="height: 20px;width: 30px;align-self: center;"   class="layui-btn layui-btn-sm">  <p style="line-height: 20px;margin-left: -3px;"><i  class="layui-icon">&#xe640;</i></p>'
                        + '</button>'
                        + '</div>'
                        + '</th>';
                })
                $("#report_content").append(str);
            }
        })
    })


    function updat_report(id) {
        $(location).attr("href", "updata_report.html?id=" + id);
    }


    function delete_report(id) {
        $(location).attr("href", "updata_report.htmlupdata_report.html?id=" + id);
    }



    function delete_report(id) {
        layer.confirm('确定要删除吗？', {
            btn: ['确定', '取消']
        }, function () {
            $.ajax({
                type: 'delete',
                url: domainName + '/project-report/report/del/' + id,
                success: function (data) {
                    window.location.reload();
                    layer.msg("删除成功");
                }
            });
            layer.close(1);
        });
    }
</script>


</html>