<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>资金使用</title>
    <link rel="stylesheet" type="text/css" media="screen" href="../../../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../../css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../../layui/css/layui.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../list-layout/css/details.css">
</head>

<body>
<!-- 按钮组 -->
<div class="btn-box">
    <!--<div style="display: block;">
        <a href="fundUseAll.html" class="layui-btn  layui-btn-sm" style="width:100%;">
            <i class="layui-icon layui-icon-return"></i>全&nbsp;&nbsp;&nbsp;&nbsp;部</a>
    </div>-->
    <div style="display: block;">
        <a onclick=" history.back(-1);" class="layui-btn  layui-btn-sm" style="width:100%;display: block;">
            <i class="layui-icon layui-icon-return"></i>返&nbsp;&nbsp;&nbsp;&nbsp;回</a>
    </div>
</div>
<!-- 基本信息 -->
<div style="position: relative;">
    <div class="content">
        <p class="title">资金使用</p>
        <table class="layui-table" id="fundBudgetAll">
            <colgroup>
                <col width="25%">
                <col width="25%">
                <col width="25%">
                <col width="25%">
            </colgroup>
            <!--<thead>
                <tr>
                    <th>科目</th>
                    <th>金额</th>
                    <th>剩余</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>工本费</td>
                    <td>30（万）</td>
                    <td>10万</td>
                    <td>详情</td>
                </tr>
            </tbody>-->
        </table>
    </div>
</div>
</body>

<script src="../../../js/constant.js"></script>
<script type="text/javascript" src="../../../js/libs/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../../../js/jq.js"></script>
<script type="text/javascript" src="../../../js/plugin/datatables/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="../../../js/plugin/datatables/dataTables.bootstrap.min.js"></script>
<script type="text/javascript" src="../../../layui/layui.js"></script>
<script type="text/javascript" src="../../../js/common.js"></script>
<script type="text/javascript" src="../../../js/my/permission.js"></script>
<script type="text/javascript">
    layui.use(['layer'], function () {
        var layer = layui.layer;
    });

    var id = getUrlParam("id");
    fundUseAll(id);
    function fundUseAll(id){
        $.ajax({
            type : 'get',
            url : domainName + '/project-item/item/fund/use/all/'+id,
            async : false,
            success : function(data) {
                var str1;
                var str2;
                var str3 = '';
                var count=0;
                $(data).each(function () {
                    count+=this.money;
                    //var surplus = this.money - useCount;
                    str1 = '<thead>\n' +
                        '       <tr>\n' +
                        '           <th>日期</th>\n' +
                        '           <th>使用今额(万元)</th>\n' +
                        '           <th>开支内容</th>\n' +
                        '           <th>操作</th>\n' +
                        '       </tr>\n' +
                        '   </thead>\n' +
                        '   <tbody>';
                    str2 = '<tbody>';
                    str3 += '<tr>\n' +
                        '       <td>'+this.edit_dateStr+'</td>\n' +
                        '       <td>'+this.expenditure+'</td>\n' +
                        '       <td>'+this.remark+'</td>\n' +
                        '       <td>' +
                        '           <a onclick="useInfo('+this.id+');" class="layui-btn layui-btn-xs">详情</a>' +
                        '           <a onclick="update('+this.id+');" class="layui-btn layui-btn-xs"><i class="layui-icon">&#xe642;</i></a>' +
                        '           <a onclick="del('+this.id+');" class="layui-btn layui-btn-xs"><i class="layui-icon">&#xe640;</i></a>' +
                        '       </td>\n' +
                        '    </tr>';
                });
                $("#fundBudgetAll").append(str1);
                $("#fundBudgetAll").append(str3);
                $("#fundBudgetAll").append(str2);
            }
        });
    }

    function useInfo(id){
        layer.open({
            title:"使用详情",
            type: 2,
            area: ['800px', '500px'],
            maxmin: true,
            shadeClose: true,
            content: ['useInfoOne.html?id='+id]
        });
    }
    function update(id){
        layer.open({
            title:"修改使用资金",
            type: 2,
            area: ['800px', '500px'],
            maxmin: true,
            shadeClose: true,
            content: ['updateFundUse.html?id='+id]
        });
    }
    function del(id){
        layer.confirm('确定要删除吗？', {
            btn: ['确定', '取消']
        }, function () {
            $.ajax({
                type: 'delete',
                url: domainName + '/project-item/item/fund/use/' + id,
                success: function (data) {
                    window.location.reload();
                    layer.msg("删除成功");
                }
            });
            layer.close(1);
        });
    }
</script>

</html>