<!DOCTYPE html>
<html lang="en-us" id="extr-page">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" media="screen" href="../../../css/bootstrap.min.css">
</head>
<body>
<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <form class="form-horizontal" onsubmit="return false" id="form">
        <fieldset>
            <div class="form-group">
                <input type="hidden" value="" id="itemId" name="itemId">
                <label class="col-md-2 control-label">研究领域</label>
                <div class="col-md-10">
                    <select class="form-control input-sm" id="select" name="labelSign">
                        <!--  <option value="1">男</option>
                          <option value="0">女</option>-->
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">数量</label>
                <div class="col-md-10">
                    <input class="form-control" placeholder="专家数量" type="text" name="population" maxlength="50"
                           data-bv-notempty="true"
                           data-bv-notempty-message="专家数量 不能为空">
                </div>
            </div>
            <div class="form-group" id="expert">
                <label class="col-md-2 control-label">已匹配</label>
                <div class="col-md-10">
                    <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;" id="experts">
                    </blockquote>
                </div>
            </div>
            <div class="form-actions">
                <div class="row" align="center">
                    <div class="col-md-12">
                        <!--<button class="btn btn-primary" onclick=" history.back(-1);">返回</button>-->
                        <button class="btn btn-primary" type="submit" onclick="match()">
                            <i class="fa fa-save"></i> <span id="t">匹配专家</span>
                        </button>
                    </div>
                </div>
            </div>
        </fieldset>
    </form>
</div>

<script src="../../../js/constant.js"></script>
<script type="text/javascript" src="../../../js/libs/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../../../js/jq.js"></script>
<script type="text/javascript" src="../../../js/plugin/bootstrapvalidator/bootstrapValidator.min.js"></script>
<script type="text/javascript" src="../../../js/common.js"></script>
<script type="text/javascript" src="../../../layui/layui.js"></script>

<script type="text/javascript" src="../../../js/project/basis.js"></script>
<script type="text/javascript">
    layui.use('layer', function(){
        var layer = layui.layer;
    });

    var id = getUrlParam("id");
    $("#itemId").val(id);

    initSelect('profession')

    /*研究领域*/
    function initSelect(sign){
        $.ajax({
            type : 'get',
            url : domainName + '/api-label/label/tree/'+sign,
            async : false,
            success : function(data) {
                var select = $("#select");
                //select.append("<option value=''>- 请选择 -</option>");
                var ds = data[0].child;
                for(var i=0; i<ds.length; i++){
                    var d = ds[i];
                    var sign = d['sign'];
                    var name = d['content'];
                    select.append("<option value='"+ sign +"'>" +name+"</option>");
                }
            }
        });
    }
    function match(){
        $('#form').bootstrapValidator();
        var bootstrapValidator = $("#form").data('bootstrapValidator');
        bootstrapValidator.validate();
        if (!bootstrapValidator.isValid()) {
            return;
        }

        var formdata = $("#form").serializeObject();
        $.ajax({
            type : 'post',
            url : domainName + '/project-user/item/match/expert',
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(formdata),
            async : false,
            success : function(data) {
                layer.msg("成功！，可继续匹配");
                $('#t').text('继续匹配');
            }
        });
    }
</script>
</body>
</html>