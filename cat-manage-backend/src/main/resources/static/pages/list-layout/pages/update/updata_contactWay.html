<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>基本信息</title>
    <link rel="stylesheet" type="text/css" media="screen" href="../../../../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../../../css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../../../layui/css/layui.css">
    <link rel="stylesheet" type="text/css" media="screen" href="../../css/details.css">
</head>
<style>
    .layui-table thead tr {
        background: #dbe7f3;
        text-align: center;
    }

    .layui-table th {
        text-align: center;
        font-weight: 400;
    }

    .layui-btn {
        background-color: #a0a8c5;
    }

    /*
    .form-actions {
        margin-top: 100px;
    }*/
    .layui-input:focus, .layui-textarea:focus {
        border-color: #66afe9 !important;
        box-shadow: rgba(102, 175, 233, 0.9) 0px 0px 8px;
    }

    /* .content{
         width: 90%;
         margin: 0 auto;
         position: relative;
     }*/
</style>
</head>

<body>
<div class="content">
    <div class="module">
        <form class="layui-form" id="form7">
            <table lay-even class="layui-table">
                <colgroup>
                    <col width="10%">
                    <col width="15%">
                    <col width="40%">
                </colgroup>
                <thead>
                <th class="header" colspan="3">签订合同各方联系方式</th>
                </thead>
                <tbody>
                <tr>
                    <td rowspan="6">甲方
                        <input type="hidden" name="id" id="id0">
                        <input type="hidden" name="item_id">
                        <input type="hidden" name="type" value="0">
                    </td>
                    <td>联系人</td>
                    <td><input style="border: none;" class="form-control" placeholder="联系人" type="text"
                               name="linkman" id="linkman0" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="联系人 不能为空"></td>
                </tr>
                <tr>
                    <td>电话</td>
                    <td><input style="border: none;" class="form-control" placeholder="电话" type="text"
                               name="phone" id="phone0" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="电话 不能为空"></td>
                </tr>
                <tr>
                    <td>传真</td>
                    <td><input style="border: none;" class="form-control" placeholder="传真"
                               type="text" name="fax" id="fax0" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="传真 不能为空"></td>
                </tr>
                <tr>
                    <td>邮编</td>
                    <td><input style="border: none;" class="form-control" placeholder="邮编" type="text"
                               name="postal_code" id="postal_code0" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="邮编 不能为空"></td>
                </tr>
                <tr>
                    <td>地址</td>
                    <td><input style="border: none;" class="form-control" placeholder="地址" type="text"
                               name="site" id="site0" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="地址 不能为空"></td>
                </tr>
                <tr>
                    <td>E-mail(电子邮箱)</td>
                    <td><input style="border: none;" class="form-control" placeholder="E-mail(电子邮箱)" type="text"
                               name="email" id="email0" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="E-mail(电子邮箱) 不能为空"></td>
                </tr>
                </tbody>
                <tbody>
                <tr>
                    <td rowspan="6">乙方
                        <input type="hidden" name="id" id="id1">
                        <input type="hidden" name="item_id">
                        <input type="hidden" name="type" value="1">
                    </td>
                    <td>联系人</td>
                    <td><input style="border: none;" class="form-control" placeholder="联系人" type="text"
                               name="linkman" id="linkman1"  maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="联系人 不能为空"></td>
                </tr>
                <tr>
                    <td>电话</td>
                    <td><input style="border: none;" class="form-control" placeholder="电话" type="text"
                               name="phone" id="phone1" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="电话 不能为空"></td>
                </tr>
                <tr>
                    <td>传真</td>
                    <td><input style="border: none;" class="form-control" placeholder="传真"
                               type="text" name="fax" id="fax1" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="传真 不能为空"></td>
                </tr>
                <tr>
                    <td>邮编</td>
                    <td><input style="border: none;" class="form-control" placeholder="邮编" type="text"
                               name="postal_code" id="postal_code1" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="邮编 不能为空"></td>
                </tr>
                <tr>
                    <td>地址</td>
                    <td><input style="border: none;" class="form-control" placeholder="地址" type="text"
                               name="site" id="site1" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="地址 不能为空"></td>
                </tr>
                <tr>
                    <td>E-mail(电子邮箱)</td>
                    <td><input style="border: none;" class="form-control" placeholder="E-mail(电子邮箱)" type="text"
                               name="email" id="email1"  maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="E-mail(电子邮箱) 不能为空"></td>
                </tr>
                </tbody>
                <tbody>
                <tr>
                    <td rowspan="6">丙方
                        <input type="hidden" name="id" id="id2">
                        <input type="hidden" name="item_id">
                        <input type="hidden" name="type" value="2">
                    </td>
                    <td>联系人</td>
                    <td><input style="border: none;" class="form-control" placeholder="联系人" type="text"
                               name="linkman" id="linkman2" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="联系人 不能为空"></td>
                </tr>
                <tr>
                    <td>电话</td>
                    <td><input style="border: none;" class="form-control" placeholder="电话" type="text"
                               name="phone" id="phone2" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="电话 不能为空"></td>
                </tr>
                <tr>
                    <td>传真</td>
                    <td><input style="border: none;" class="form-control" placeholder="传真"
                               type="text" name="fax" id="fax2" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="传真 不能为空"></td>
                </tr>
                <tr>
                    <td>邮编</td>
                    <td><input style="border: none;" class="form-control" placeholder="邮编" type="text"
                               name="postal_code" id="postal_code2" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="邮编 不能为空"></td>
                </tr>
                <tr>
                    <td>地址</td>
                    <td><input style="border: none;" class="form-control" placeholder="地址" type="text"
                               name="site" id="site2" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="地址 不能为空"></td>
                </tr>
                <tr>
                    <td>E-mail(电子邮箱)</td>
                    <td><input style="border: none;" class="form-control" placeholder="E-mail(电子邮箱)" type="text"
                               name="email" id="email2" maxlength="50" data-bv-notempty="true"
                               data-bv-notempty-message="E-mail(电子邮箱) 不能为空"></td>
                </tr>
                </tbody>
            </table>
            <div class="form-actions">
                <div class="row" align="center">
                    <div class="col-md-12">
                        <button class="btn btn-primary" onclick="retuen_btn();">返回</button>
                        <button class="btn btn-primary" type="submit" onclick="addContact();">
                            <i class="fa fa-save"></i> 保存
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
</body>
<script src="../../../../js/constant.js"></script>
<script type="text/javascript" src="../../../../js/libs/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="../../../../js/jq.js"></script>
<script type="text/javascript" src="../../../../js/plugin/datatables/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="../../../../js/plugin/datatables/dataTables.bootstrap.min.js"></script>
<script type="text/javascript" src="../../../../layui/layui.js"></script>
<script type="text/javascript" src="../../../../js/common.js"></script>
<script type="text/javascript" src="../../../../js/my/permission.js"></script>
<script type="text/javascript" src="../../../list-layout/js/serializeJson.js"></script>
<script type="text/javascript">
    var id = getUrlParam("id");
  $("input[name=item_id]").val(id);
    layui.use(['layer', 'form', 'laydate', 'upload'], function () {
        var layer = layui.layer
            , upload = layui.upload
            , form = layui.form
            , laydate = layui.laydate;
        lay('.date').each(function () {
            laydate.render({
                elem: this
                , showBottom: false
                , trigger: 'click'
            });
        });
        //监听提交
        form.on('submit(formDemo)', function (data) {
            layer.msg(JSON.stringify(data.field));
            return false;
        });
    });
    getCompanyInfo(id);
    function getCompanyInfo(id) {
        $.ajax({
            type: 'get',
            url: domainName + '/project-item/item/company/list',
            data: "item_id=" + id,
            async: false,
            success: function (data) {
                $(data).each(function () {
                    if (this.type == 0) {
                        $("#id0").val(this.id);
                        $("#phone0").val(this.phone);
                        $("#postal_code0").val(this.postal_code);
                        $("#site0").val(this.site);
                        $("#email0").val(this.email);
                        $("#fax0").val(this.fax);
                        $("#linkman0").val(this.linkman);
                    } else if (this.type == 1) {
                        $("#id1").val(this.id);
                        $("#phone1").val(this.phone);
                        $("#linkman1").val(this.linkman);
                        $("#postal_code1").val(this.postal_code);
                        $("#site1").val(this.site);
                        $("#email1").val(this.email);
                        $("#fax1").val(this.fax);
                    } else if (this.type == 2) {
                        $("#id2").val(this.id);
                        $("#phone2").val(this.phone);
                        $("#postal_code2").val(this.postal_code);
                        $("#site2").val(this.site);
                        $("#email2").val(this.email);
                        $("#fax2").val(this.fax);
                        $("#linkman2").val(this.linkman);
                    }
                })
            }
        })
    }

    function addContact() {
        var formdata = $("#form7").serializeJson();
        $.ajax({
            type: 'put',
            url: domainName + '/project-item/item/company/multi',
            async: false,
            contentType: "application/json; charset=utf-8",
            data: formdata,
            success: function (data) {
                var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
                parent.location.reload();//刷新父页面，注意一定要在关闭当前iframe层之前执行刷新
                parent.layer.close(index); //再执行关闭
            }
        });
    }
    function retuen_btn() {
        var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
        parent.location.reload();//刷新父页面，注意一定要在关闭当前iframe层之前执行刷新
        parent.layer.close(index); //再执行关闭
    }
</script>
</html>